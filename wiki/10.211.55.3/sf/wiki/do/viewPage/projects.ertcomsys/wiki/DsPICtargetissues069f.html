



















  
  

  







<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<!-- Mirrored from 10.211.55.3/sf/wiki/do/viewPage/projects.ertcomsys/wiki/DsPICtargetissues?selectedTab=versions&wikiPageVersion=5 by HTTrack Website Copier/3.x [XR&CO'2010], Sun, 03 Apr 2011 21:15:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
<head>
  <title>SourceForge : View Wiki Page: DsPICtargetissues</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  
  <link rel="stylesheet" type="text/css" href="http://10.211.55.3/css/styles_new.css" />
  <link rel="shortcut icon" href="http://10.211.55.3/sf-images/icons/favicon.ico" />
  <script language="JavaScript" src="http://10.211.55.3/sf/js/sf_functions.js" type="text/javascript"></script>
  
  
  
  
</head>

  <body>


<!-- SourceForge masthead begin -->


<script type="text/javascript" src="http://10.211.55.3/sf-help/RoboHelp_CSH.js"></script>
<script type="text/javascript">
                      var helpRoot = '/sf-help/en/index.htm>HelpWin';
    
    // show help for a topic
    function showTopicHelp(topicId) {
	// First, close the help menu
	closeMenu(activeButton);
	RH_ShowHelp(0, helpRoot, HH_HELP_CONTEXT, topicId);
    }

    // show help for a topic
    function showTopicHelpDirectly(topicId) {
	RH_ShowHelp(0, helpRoot, HH_HELP_CONTEXT, topicId);
    }

    // show the help table of contents
    function showHelpContents() {
	// First, close the help menu
	closeMenu(activeButton);
	RH_ShowHelp(0, helpRoot, HH_DISPLAY_TOC, 0);
    }

    // show the help index
    function showHelpIndex() {
	// First, close the help menu
	closeMenu(activeButton);
	RH_ShowHelp(0, helpRoot, HH_DISPLAY_INDEX, 0);
    }

    // show the help index (not from a menu)
    function showHelpIndexFromLink() {
	RH_ShowHelp(0, helpRoot, HH_DISPLAY_INDEX, 0);
    }
</script>

<div id="ProjectMenu" class="menu">
      <a class="menuItem" href="http://10.211.55.3/sf/projects/ertcomsys">Scalios</a>
      <div class="menuItemSep"></div>
    <a class="menuItem" href="http://10.211.55.3/sf/sfmain/do/myProjects?selectedTab=my">My Projects</a>
    <a class="menuItem" href="http://10.211.55.3/sf/sfmain/do/myProjects?selectedTab=all">All Projects</a>
</div>

<div id="SearchMenu" class="menu">
  <a class="menuItem" href="http://10.211.55.3/sf/search/do/quickJump" onClick="window.open('/sf/search/do/quickJump', 'quickjumpwindow', 'width=540,height=263'); closeMenu(activeButton); return false">Quick Jump</a>
  <a class="menuItem" id="search" href="http://10.211.55.3/sf/search/do/search">Search</a>
</div>

<div id="HelpMenu2" class="menu">
    <a class="menuItem" href="javascript:showTopicHelp(16)">Help for this Page</a>
<a class="menuItem" href="javascript:showHelpContents()">Help Contents</a>
<a class="menuItem" href="javascript:showHelpIndex()">Help Index</a>
<a class="menuItem" href="http://10.211.55.3/sf-help/en/doc/User_Guide.pdf">User Guide</a>
<div class="menuItemSep"></div>
<a class="menuItem" href="http://10.211.55.3/sf/global/do/about" onclick="javascript:closeMenu(activeButton); window.open('/sf/global/do/about','sfpabout','height=450,width=600'); return false;">About SourceForge</a>
</div>

<table width="100%" border="0" cellpadding="0" cellspacing="0" class="mastHeadBackground">
 <tr>
  <td>
   <table width="300" border="0" cellpadding="0" cellspacing="0" class="mastHeadLink">
     <tr class="mastHeadLinkSpacing">
       <td nowrap="nowrap" valign="middle"><a href="http://10.211.55.3/sf/sfmain/do/home" target="_top"><img src="http://10.211.55.3/sf-images/masthead/logo-custom.gif" border="0" align="absmiddle"><img src="http://10.211.55.3/sf-images/masthead/logo.gif" border="0" align="absmiddle"></a></td>
                    <td nowrap="nowrap" class="mastHeadLink"><a href="http://10.211.55.3/sf/sfmain/do/home" target="_top">Home</a></td>
       <td nowrap="nowrap" class="mastHeadLinkSpacing"> </td>

                          <td nowrap="nowrap" class="mastHeadLink"><a href="http://10.211.55.3/sf/categorization/do/browse/projects/categorization.root" target="_top">Project Categories</a></td>
         <td nowrap="nowrap" class="mastHeadLinkSpacing"> </td>
       
               <td nowrap="nowrap" class="mastHeadLink"><a href="http://10.211.55.3/sf/sfmain/do/myPage" target="_top">My&nbsp;Workspace</a></td>
       <td nowrap="nowrap" class="mastHeadLinkSpacing"> </td>
       
               <td nowrap="nowrap" class="mastHeadLinkSelected"><a href="#" onclick="return buttonClick(this, 'ProjectMenu');">Projects<img src="http://10.211.55.3/sf-images/masthead/dropdown.gif" width="7" height="4" hspace="2" border="0"></a></td>
       <td nowrap="nowrap" class="mastHeadLinkSpacing"> </td>
               <td nowrap="nowrap" class="mastHeadLink"><a href="#" onclick="return buttonClick(this, 'SearchMenu');">Search<img src="http://10.211.55.3/sf-images/masthead/dropdown.gif" width="7" height="4" hspace="2" border="0"></a></td>

     
                          <td nowrap="nowrap" class="mastHeadLinkSpacing"> </td>
         <td nowrap="nowrap" class="mastHeadLink"><a href="https://sourceforge-enterprise.com" target="_blank">Community Support</a></td>
            
                 
     </tr>
   </table>
  </td>
  <td align="right">
    <table border="0" cellspacing="0" cellpadding="0" class="mastHeadLink">
      <tr class="mastHeadLink">
                  <td nowrap="nowrap" id="UserLoggedIn">Logged In:&nbsp;JK Energy&nbsp;<div id="CurrentUsername" style="display: none;">jkenergy</div></td>
          <td nowrap="nowrap"><img src="http://10.211.55.3/sf-images/masthead/vertical_line.gif" width="1" height="19" hspace="4"></td>
          <td nowrap="nowrap">&nbsp;<a href="#" onclick="return buttonClick(this, 'HelpMenu2');"><img src="http://10.211.55.3/sf-images/masthead/help.gif" width="21" height="21" border="0"></a></td>
          <td nowrap="nowrap">&nbsp;<a href="http://10.211.55.3/sf/sfmain/do/logout" target="_top"><img src="http://10.211.55.3/sf-images/masthead/logout.gif" alt="Logout" width="19" height="21" border="0"></a></td>
              </tr>
    </table>
  </td>
  </tr>
  <tr>
    <td colspan="2" class="black"><img src="http://10.211.55.3/sf-images/misc/pixel.gif" width="1" height="1"></td>
  </tr>
</table>

<!-- SourceForge masthead end -->

<!-- SourceForge buttonbar begin -->
<table class="TopMenu">
    <tr class="ButtonRow">
        <td class="VerticalSeparatorNoBorder"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                   <td class="Button " onclick="window.location = '/sf/projects/ertcomsys'; return false;"><a href="http://10.211.55.3/sf/projects/ertcomsys" target="_top"><img src="http://10.211.55.3/sf-images/project/project-homeicon.gif" width="25" height="20" border="0"><br>Project&nbsp;Home</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/tracker/do/listTrackers/projects.ertcomsys/tracker'; return false;"><a href="http://10.211.55.3/sf/tracker/do/listTrackers/projects.ertcomsys/tracker" target="_top"><img src="http://10.211.55.3/sf-images/project/project-trackericon.gif" width="25" height="20" border="0"><br>Tracker</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/docman/do/listDocuments/projects.ertcomsys/docman.root'; return false;"><a href="http://10.211.55.3/sf/docman/do/listDocuments/projects.ertcomsys/docman.root" target="_top"><img src="http://10.211.55.3/sf-images/project/project-documentsicon.gif" width="25" height="20" border="0"><br>Documents</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/taskmgr/do/viewSummary/projects.ertcomsys/taskmgr'; return false;"><a href="http://10.211.55.3/sf/taskmgr/do/viewSummary/projects.ertcomsys/taskmgr" target="_top"><img src="http://10.211.55.3/sf-images/project/project-tasksicon.gif" width="25" height="20" border="0"><br>Tasks</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/scm/do/listRepositories/projects.ertcomsys/scm'; return false;"><a href="http://10.211.55.3/sf/scm/do/listRepositories/projects.ertcomsys/scm" target="_top"><img src="http://10.211.55.3/sf-images/project/project-scmicon.gif" width="25" height="20" border="0"><br>Source&nbsp;Code</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/discussion/do/listForums/projects.ertcomsys/discussion'; return false;"><a href="http://10.211.55.3/sf/discussion/do/listForums/projects.ertcomsys/discussion" target="_top"><img src="http://10.211.55.3/sf-images/project/project-forumsicon.gif" width="25" height="20" border="0"><br>Discussions</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/reporting/do/listReports/projects.ertcomsys/reporting'; return false;"><a href="http://10.211.55.3/sf/reporting/do/listReports/projects.ertcomsys/reporting" target="_top"><img src="http://10.211.55.3/sf-images/project/project-reportsicon.gif" width="25" height="20" border="0"><br>Reports</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/frs/do/viewSummary/projects.ertcomsys/frs'; return false;"><a href="http://10.211.55.3/sf/frs/do/viewSummary/projects.ertcomsys/frs" target="_top"><img src="http://10.211.55.3/sf-images/project/project-releasesicon.gif" width="25" height="20" border="0"><br>File Releases</a></td>
                                    <td class="SelectedLeft"><img src="http://10.211.55.3/sf-images/misc/pixel.gif" border="0" height="1" width="4"></td>
           <td class="Button Selected" onclick="window.location = '/sf/wiki/do/viewPage/projects.ertcomsys/wiki/HomePage'; return false;"><a href="HomePage.html" target="_top"><img src="http://10.211.55.3/sf-images/project/project-wikiicon.gif" width="25" height="20" border="0"><br>Wiki</a></td>
           <td class="SelectedRight"><img src="http://10.211.55.3/sf-images/misc/pixel.gif" border="0" height="1" width="4"/></td>
                  <td class="VerticalSeparatorNoBorder"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                             <td class="Button " onclick="window.location = '/sf/sfmain/do/projectAdmin/projects.ertcomsys'; return false;"><a href="http://10.211.55.3/sf/sfmain/do/projectAdmin/projects.ertcomsys" target="_top"><img src="http://10.211.55.3/sf-images/project/project-projectadminicon.gif" width="25" height="20" border="0"><br>Project&nbsp;Admin</a></td>
                  <td class="VerticalSeparator"><img src="http://10.211.55.3/sf-images/misc/white.gif" border="0" height="40" width="1"></td>
                           <td class="ButtonEnd"></td>
             </tr>

  <tr class="ShadowRow">
        
                  <td colspan="16"></td>
            <td class="SelectedLeft"></td>
      <td class="Selected"></td>
      <td class="SelectedRight"></td>
              <td colspan="4"></td>
  </tr>
  </table>

<!-- SourceForge buttonbar end -->

<!-- SourceForge content-area begin -->
<div class="contentArea">

<!-- SourceForge crumbs begin -->
<div style="padding-bottom: 2px;">
    <span class="searchlink">
        <a href="http://10.211.55.3/sf/wiki/do/searchWikiPages/projects.ertcomsys/wiki/DsPICtargetissues" id="searchWikiPagesLink">Search Wiki Pages</a>
      </span>
    <span class="mainnavHeader"><strong class="ProjectProminent">Project: Scalios</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://10.211.55.3/sf/go/projects.ertcomsys/wiki">Wiki</a>&nbsp;&gt;&nbsp;</span><a href="DsPICtargetissues.html">DsPICtargetissues</a>&nbsp;&gt;&nbsp;<strong>View Wiki Page</strong>
  </div>
<!-- SourceForge crumbs end -->

<!-- SourceForge messages begin -->







<div style="padding-bottom: 2px; padding-top: 6px;">



</div>
<!-- SourceForge messages end -->

<!-- SourceForge content begin -->
<div style="padding-top: 10px; width: auto;">
    <table class="ItemDetailContainer">
      <tr class="ContainerHeader">
        <td>
          





          wiki1054: DsPICtargetissues
          
            (Version 5)
          
        </td>
      </tr>
      <tr>
        <td class="ItemDetailContainerCell">
          <h4 id='section-DsPICtargetissues-DCFlag'>DC flag</h4>
<p>The dsPIC includes in the upper byte of the Status Register the DC flag. This is not part of the preserved context and any code using this flag will have to manually ensure interrupts are locked out (this is not an RTOS issue <i>per se</i>: any code with interrupts suffers from this). The C30 compiler does not use this flag.
</p>
<p>The RTOS could be updated to store SR_L (containing DC) on an interrupt, since a word is used to store PSVPAG even though PSVPAG is only 8-bits: there would be no extra stack space used. It would take a few more instructions to save and restore, though.
</p>
<h4 id='section-DsPICtargetissues-UseOfTheDSP'>Use of the DSP</h4>
<p><a class="wikipage" href="MultiThreadingOfTheDSP.html">Special support</a> is included for the DSP. The DSP context save/restore functions have to be written in assembler due to the restrictions on certain instructions appearing around certain register modifications. The C30 compiler does not use the DSP registers.
</p>
<p>The Microchip dsPIC DSP libraries all follow a certain calling convention, and this can be used to define the DSP saving/restoring function. The libraries basically save and restore all DSP registers on entry and exit of a function except for ACCA and ACCB. Thus only ACCA and ACCB need to be saved/restored by the special functions, since any interrupting task or ISR would use the DSP via a library function and only ACCA or ACCB would be corrupted on return. Thus DSP usage with the RTOS must follow the rule that registers other than ACCx must be saved before use and restored after use. Furthermore, no code may block or terminate while using the DSP (i.e. a restore must take place before terminate/block).
</p>
<h4 id='section-DsPICtargetissues-StackChecking'>Stack checking</h4>
<p>This is supported by context switching the SPLIM register.
</p>
<h4 id='section-DsPICtargetissues-DOLoopSupport'>DO loop support</h4>
<p>The DCOUNT register (and other parts of the SR associated with the DO loop support) are not included in the target.
</p>
<h4 id='section-DsPICtargetissues-TBLPAGEtc.'>TBLPAG etc.</h4>
<p>The C30 compiler does not use the TBLPAG register or generate TBLx instructions.
</p>
<h4 id='section-DsPICtargetissues-PSV'>PSV</h4>
<p>The C30 3.0 compiler now supports 'long' pointers (24 bits) where the top 8-bits carry around PSVPAG values. The compiler then manages the PSV. This means that interrupt wrappers must save and restore PSVPAG. Additionally, the PSVPAG must be set to .const on entry to the ISR functions, since all functions assume PSVPAG refers to .const. The changes are made in the zero-level handler (zlih) macros in kernelasm.inc. Unfortunately, the stack space gets larger by a word.
</p>
<p></p>

          
            
          







        </td>
      </tr>
      <tr class="ContainerFooter">
        <td>
          <div class="AlignRight">
            
            
            
              <div class="Button"><div class="Left">&nbsp;</div><div class="Middle"><a href="http://10.211.55.3/sf/wiki/do/editPage/projects.ertcomsys/wiki/DsPICtargetissues?wikiPageVersion=5" id="view_wiki_page.edit">Edit</a></div><div class="Right">&nbsp;</div></div>

            
            
          </div>
        </td>
      </tr>
    </table>

    <br/>

    
        
    

    

    <br/>
    
      <div class="AlignLeft">
        <div class="Button" id="_SfButton_showPageDetails"><div class="Left">&nbsp;</div><div class="Middle">
          <img src="http://10.211.55.3/sf-images/icons/plus_minus_closed.gif" style="vertical-align: middle;">
          <a href="DsPICtargetissues4856.html?showDetails=true&amp;wikiPageVersion=5">Show Details</a>
        </div><div class="Right">&nbsp;</div></div>

      </div>
    

    <div class="AlignRight">
      
      







    
    <div class="Button"><div class="Left">&nbsp;</div><div class="Middle">
	<a href="javascript:NewWindow('http://10.211.55.3/sf/sfmain/do/listMonitoringUsers/projects.ertcomsys/wiki/?objid=wiki1054', 'monusers', 540, 425, 'no');" class="menuItem">Users Monitoring</a>
    </div><div class="Right">&nbsp;</div></div>

    
	
	
	    <div class="Button"><div class="Left">&nbsp;</div><div class="Middle"><a href="http://10.211.55.3/sf/sfmain/do/monitor/projects.ertcomsys/wiki/DsPICtargetissues?monitorReturnTo=http%3A%2F%2Flocalhost%3A8080%2Fsf%2Fwiki%2Fdo%2FviewPage%2Fprojects.ertcomsys%2Fwiki%2FDsPICtargetissues%3FselectedTab%3Dversions%26wikiPageVersion%3D5" id="button_monitor_object">Monitor</a></div><div class="Right">&nbsp;</div></div>

	
    

    </div>
  </div>
<!-- SourceForge content end -->

</div>
<!-- SourceForge content-area end -->

<div id="PageLoaded" style="display: none;"></div>


</body>

<!-- Mirrored from 10.211.55.3/sf/wiki/do/viewPage/projects.ertcomsys/wiki/DsPICtargetissues?selectedTab=versions&wikiPageVersion=5 by HTTrack Website Copier/3.x [XR&CO'2010], Sun, 03 Apr 2011 21:15:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8"><!-- /Added by HTTrack -->
</html>

